# Backend é‡æ„æ–¹æ¡ˆï¼ˆServices + Routesï¼‰

> **æ–‡æ¡£ç‰ˆæœ¬**: 2.0
> **åˆ›å»ºæ—¶é—´**: 2026-01-12
> **æ‰€å±æ¶æ„**: Backend æ•´ä½“é‡æ„
> **çŠ¶æ€**: å¾…è¯„å®¡

---

## ç›®å½•

- [ä¸€ã€é—®é¢˜åˆ†æ](#ä¸€é—®é¢˜åˆ†æ)
- [äºŒã€é‡æ„ä»·å€¼è¯„ä¼°](#äºŒé‡æ„ä»·å€¼è¯„ä¼°)
- [ä¸‰ã€é‡æ„æ–¹æ¡ˆè®¾è®¡](#ä¸‰é‡æ„æ–¹æ¡ˆè®¾è®¡)
- [å››ã€è¿ç§»è®¡åˆ’](#å››è¿ç§»è®¡åˆ’)
- [äº”ã€é£é™©è¯„ä¼°ä¸ç¼“è§£](#äº”é£é™©è¯„ä¼°ä¸ç¼“è§£)
- [å…­ã€æˆåŠŸæŒ‡æ ‡](#å…­æˆåŠŸæŒ‡æ ‡)
- [ä¸ƒã€å®æ–½å»ºè®®](#ä¸ƒå®æ–½å»ºè®®)
- [å…«ã€ç›¸å…³æ–‡æ¡£](#å…«ç›¸å…³æ–‡æ¡£)

---

## ä¸€ã€é—®é¢˜åˆ†æ

### 1.1 å½“å‰ç›®å½•ç»“æ„

```
backend/services/
â”œâ”€â”€ claude/                    # Claude SDK ç›´æ¥è°ƒç”¨ï¼ˆéå®¹å™¨ï¼‰
â”‚   â””â”€â”€ ClaudeSDK.js (561 è¡Œ)
â”œâ”€â”€ container/                  # Docker å®¹å™¨åŒ–ç®¡ç†
â”‚   â”œâ”€â”€ claude/                # å®¹å™¨å†… Claude é›†æˆ
â”‚   â”‚   â”œâ”€â”€ ClaudeQuery.js
â”‚   â”‚   â”œâ”€â”€ DockerExecutor.js
â”‚   â”‚   â”œâ”€â”€ ScriptBuilder.js
â”‚   â”‚   â””â”€â”€ SessionManager.js
â”‚   â”œâ”€â”€ file/                  # å®¹å™¨æ–‡ä»¶æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ file-operations.js
â”‚   â”‚   â”œâ”€â”€ file-tree.js
â”‚   â”‚   â”œâ”€â”€ path-utils.js
â”‚   â”‚   â”œâ”€â”€ project-manager.js
â”‚   â”‚   â””â”€â”€ container-sessions.js
â”‚   â””â”€â”€ core/                  # å®¹å™¨æ ¸å¿ƒåŠŸèƒ½
â”‚       â”œâ”€â”€ DockerConnection.js
â”‚       â”œâ”€â”€ ContainerLifecycle.js
â”‚       â”œâ”€â”€ ContainerHealth.js
â”‚       â”œâ”€â”€ ContainerStats.js
â”‚       â”œâ”€â”€ ContainerCleanup.js
â”‚       â””â”€â”€ ContainerConfig.js
â”œâ”€â”€ project/                   # é¡¹ç›®ç®¡ç†ï¼ˆéå®¹å™¨ï¼‰
â”‚   â”œâ”€â”€ claude/
â”‚   â”‚   â”œâ”€â”€ projects.js
â”‚   â”‚   â”œâ”€â”€ sessions.js
â”‚   â”‚   â””â”€â”€ messages.js
â”‚   â”œâ”€â”€ cursor/
â”‚   â”‚   â””â”€â”€ sessions.js
â”‚   â”œâ”€â”€ codex/
â”‚   â”‚   â”œâ”€â”€ sessions.js
â”‚   â”‚   â””â”€â”€ messages.js
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ project-config.js
â”‚   â”‚   â””â”€â”€ cache.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ path-utils.js
â”‚   â”‚   â””â”€â”€ name-generator.js
â”‚   â””â”€â”€ project-management/
â”‚       â””â”€â”€ operations.js
â””â”€â”€ workspace/                 # å·¥ä½œåŒºæœåŠ¡
    â”œâ”€â”€ creator.js
    â”œâ”€â”€ github-service.js
    â””â”€â”€ path-validator.js
```

### 1.1.2 Routes ç›®å½•ç»“æ„

```
backend/routes/                 # API è·¯ç”±å±‚ï¼ˆ18ä¸ªæ–‡ä»¶ï¼‰
â”œâ”€â”€ taskmaster.js              # TaskMaster é›†æˆï¼ˆ1979 è¡Œ âš ï¸ï¼‰
â”œâ”€â”€ agent.js                   # AI ä»£ç†æ¥å£ï¼ˆ1257 è¡Œ âš ï¸ï¼‰
â”œâ”€â”€ git.js                     # Git æ“ä½œï¼ˆ1127 è¡Œ âš ï¸ï¼‰
â”œâ”€â”€ cursor.js                  # Cursor CLIï¼ˆ794 è¡Œ âš ï¸ï¼‰
â”œâ”€â”€ mcp.js                     # MCP ç®¡ç†ï¼ˆ552 è¡Œï¼‰
â”œâ”€â”€ commands.js                # å‘½ä»¤ç³»ç»Ÿï¼ˆ521 è¡Œï¼‰
â”œâ”€â”€ codex.js                   # OpenAI Codexï¼ˆ345 è¡Œï¼‰
â”œâ”€â”€ files.js                   # æ–‡ä»¶æ“ä½œï¼ˆ277 è¡Œï¼‰
â”œâ”€â”€ cli-auth.js                # CLI è®¤è¯ï¼ˆ263 è¡Œï¼‰
â”œâ”€â”€ uploads.js                 # æ–‡ä»¶ä¸Šä¼ ï¼ˆ261 è¡Œï¼‰
â”œâ”€â”€ sessions.js                # ä¼šè¯ç®¡ç†ï¼ˆ222 è¡Œï¼‰
â”œâ”€â”€ settings.js                # ç”¨æˆ·è®¾ç½®ï¼ˆ180 è¡Œï¼‰
â”œâ”€â”€ projects.js                # é¡¹ç›®ç®¡ç†ï¼ˆ166 è¡Œï¼‰
â”œâ”€â”€ auth.js                    # ç”¨æˆ·è®¤è¯ï¼ˆ142 è¡Œï¼‰
â”œâ”€â”€ user.js                    # ç”¨æˆ·ç®¡ç†ï¼ˆ108 è¡Œï¼‰
â”œâ”€â”€ system.js                  # ç³»ç»Ÿç®¡ç†ï¼ˆ91 è¡Œï¼‰
â”œâ”€â”€ mcp-utils.js               # MCP å·¥å…·ï¼ˆ48 è¡Œï¼‰
â””â”€â”€ [å…¶ä»–è·¯ç”±æ–‡ä»¶...]

**æ€»ä»£ç è¡Œæ•°**: çº¦ 8,333 è¡Œ
**è¶…å¤§æ–‡ä»¶ (>500è¡Œ)**: 6 ä¸ª
**å¤§æ–‡ä»¶ (300-500è¡Œ)**: 1 ä¸ª
**ä¸­ç­‰æ–‡ä»¶ (100-300è¡Œ)**: 9 ä¸ª
```

### 1.2 ä»£ç é‡å¤é—®é¢˜

#### Services å±‚é‡å¤

| ç±»å‹ | é‡å¤åº¦ | å½±å“æ–‡ä»¶ |
|------|--------|----------|
| **Claude æ‰§è¡Œé€»è¾‘** | 85% | `container/claude/` vs `claude/` |
| **JSONL ä¼šè¯è§£æ** | 95% | `project/claude/sessions.js` vs `container/file/container-sessions.js` |
| **ä¼šè¯ç®¡ç†** | 70% | å¤šä¸ªç‹¬ç«‹çš„ SessionManager å®ç° |
| **è·¯å¾„å·¥å…·** | 60% | `project/utils/path-utils.js` vs `container/file/path-utils.js` |

#### Routes å±‚é‡å¤

| ç±»å‹ | é‡å¤åº¦ | å½±å“æ–‡ä»¶ |
|------|--------|----------|
| **è·¯å¾„å¤„ç†å‡½æ•°** | 75% | `getProjectPath`, `getActualProjectPath`, `extractProjectDirectory` (å¤šå¤„) |
| **é”™è¯¯å¤„ç†å“åº”** | 90% | æ‰€æœ‰è·¯ç”±æ–‡ä»¶ (çº¦ 80+ å¤„é‡å¤) |
| **å®¹å™¨æ¨¡å¼æ£€æŸ¥** | 80% | `if (CONTAINER_MODE === '1')` (15+ å¤„) |
| **è®¤è¯ä¸­é—´ä»¶** | 95% | `authenticateToken` æ¨¡å¼ (20+ å¤„) |

#### æ•´ä½“ç»Ÿè®¡

| æŒ‡æ ‡ | Services | Routes | åˆè®¡ |
|------|----------|--------|------|
| **æ€»ä»£ç è¡Œæ•°** | ~12,000 | ~8,333 | ~20,333 |
| **é‡å¤ä»£ç è¡Œæ•°** | ~3,600 (30%) | ~3,600 (43%) | ~7,200 (35%) |
| **å¯ä¼˜åŒ–ä»£ç è¡Œæ•°** | ~2,400 | ~1,200 | ~3,600 |

### 1.3 æ¶æ„é—®é¢˜

#### é—®é¢˜ 1ï¼šç¼ºä¹æŠ½è±¡å±‚

```javascript
// å½“å‰ä»£ç éœ€è¦æ˜¾å¼æ£€æŸ¥æ¨¡å¼
if (CONTAINER_MODE === '1') {
  result = await getSessionMessagesInContainer(userId, projectName, sessionId, limit, offset);
} else {
  result = await getSessionMessages(projectName, sessionId, limit, offset);
}
```

#### é—®é¢˜ 2ï¼šèŒè´£ä¸æ¸…

- `ClaudeSDK.js` (561 è¡Œ)ï¼šæ‰¿æ‹… SDK è°ƒç”¨ã€ä¼šè¯ç®¡ç†ã€æ¶ˆæ¯å¤„ç†ç­‰å¤šé‡èŒè´£
- ä¼šè¯ç®¡ç†é€»è¾‘åˆ†æ•£åœ¨ 6+ ä¸ªæ–‡ä»¶ä¸­
- æ–‡ä»¶æ“ä½œé€»è¾‘æ··æ‚åœ¨å¤šå¤„

#### é—®é¢˜ 3ï¼šæ‰©å±•æ€§å·®

- æ–°å¢ AI ä»£ç†éœ€è¦å¤åˆ¶å¤§é‡ä»£ç 
- å®¹å™¨/éå®¹å™¨åˆ‡æ¢éœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç 

### 1.4 ä¾èµ–å…³ç³»é—®é¢˜

```
Services å±‚ä¾èµ–å¤æ‚åº¦ï¼š
- container/claude ä¾èµ– container/core (6ä¸ªæ¨¡å—)
- project/claude ä¾èµ– project/utils, project/config, project/cursor, project/codex
- è·¨å±‚ä¾èµ–ï¼šcontainer æ¨¡å—ç›´æ¥å¯¼å…¥ configï¼ˆ../../../config/config.jsï¼‰
```

### 1.5 Routes å±‚æ¶æ„é—®é¢˜

#### é—®é¢˜ 1ï¼šèƒ–è·¯ç”±ï¼ˆFat Routesï¼‰

è·¯ç”±æ–‡ä»¶åŒ…å«å¤§é‡ä¸šåŠ¡é€»è¾‘ï¼š

| æ–‡ä»¶ | è¡Œæ•° | ä¸šåŠ¡é€»è¾‘ç±»å‹ |
|------|------|-------------|
| **taskmaster.js** | 1979 | TaskMaster CLI æ£€æµ‹ã€MCP æœåŠ¡å™¨æ£€æµ‹ã€å…ƒæ•°æ®ç®¡ç† |
| **agent.js** | 1257 | GitHub é›†æˆã€é¡¹ç›®ç®¡ç†ã€API å¯†é’¥éªŒè¯ |
| **git.js** | 1127 | Git æ“ä½œã€diff å¤„ç†ã€ä»“åº“éªŒè¯ |
| **cursor.js** | 794 | Cursor CLI è°ƒç”¨ã€ä¼šè¯ç®¡ç† |

**ç¤ºä¾‹**ï¼ˆtaskmaster.js:48-100ï¼‰ï¼š
```javascript
// è·¯ç”±æ–‡ä»¶ä¸­ç›´æ¥å®ç° CLI æ£€æµ‹é€»è¾‘
async function checkTaskMasterInstallation() {
  return new Promise((resolve) => {
    const child = spawn('which', ['task-master'], { ... });
    // ... 50+ è¡Œä¸šåŠ¡é€»è¾‘
  });
}
```

#### é—®é¢˜ 2ï¼šè¿ååˆ†å±‚æ¶æ„

**ç›´æ¥æ•°æ®åº“è®¿é—®**ï¼š
- `settings.js` â†’ ç›´æ¥å¯¼å…¥ `repositories`
- `auth.js` â†’ ç›´æ¥å¯¼å…¥ `User`, `ApiKey`
- `user.js` â†’ ç›´æ¥å¯¼å…¥ `repositories`

**è·¨å±‚ä¾èµ–**ï¼š
- è·¯ç”± â†’ æœåŠ¡å±‚ï¼ˆæ­£å¸¸ï¼‰
- è·¯ç”± â†’ æ•°æ®åº“å±‚ï¼ˆâŒ è¿ååˆ†å±‚ï¼‰
- è·¯ç”± â†’ å·¥å…·å±‚ï¼ˆâŒ åº”è¯¥é€šè¿‡æœåŠ¡å±‚ï¼‰

#### é—®é¢˜ 3ï¼šè€¦åˆåº¦è¿‡é«˜

| è·¯ç”±æ–‡ä»¶ | ä¾èµ–æ•° | è€¦åˆåº¦ | ä¸»è¦ä¾èµ– |
|---------|--------|--------|----------|
| agent.js | 10+ | é«˜ | database, services(claude,cursor,codex), utils, config |
| git.js | 5+ | ä¸­ | services(claude,cursor), utils |
| taskmaster.js | 6+ | ä¸­ | services, utils, config |

#### é—®é¢˜ 4ï¼šç¼ºä¹ç»Ÿä¸€çš„é”™è¯¯å¤„ç†

æ¯ä¸ªè·¯ç”±æ–‡ä»¶éƒ½æœ‰è‡ªå·±çš„é”™è¯¯å¤„ç†æ¨¡å¼ï¼š
```javascript
// agent.js - 12 å¤„ä¸åŒçš„é”™è¯¯å“åº”
// git.js - 25 å¤„ä¸åŒçš„é”™è¯¯å“åº”
// files.js - 15 å¤„ä¸åŒçš„é”™è¯¯å“åº”
```

#### é—®é¢˜ 5ï¼šè·¯ç”±ç»„ç»‡æ··ä¹±

- MCP åŠŸèƒ½åˆ†æ•£åœ¨ `mcp.js`, `mcp-utils.js`, å…¶ä»–è·¯ç”±
- è®¤è¯ç›¸å…³åŠŸèƒ½åˆ†æ•£åœ¨ `auth.js`, `cli-auth.js`, `settings.js`
- æ–‡ä»¶åŠŸèƒ½åˆ†æ•£åœ¨ `files.js`, `uploads.js`, é¡¹ç›®è·¯ç”±ä¸­

---

## äºŒã€é‡æ„ä»·å€¼è¯„ä¼°

### 2.1 ç§¯ææŒ‡æ ‡ï¼ˆå€¼å¾—é‡æ„ï¼‰

| æŒ‡æ ‡ | å½“å‰çŠ¶æ€ | é‡æ„å | æ”¹è¿› |
|------|----------|--------|------|
| **æ•´ä½“ä»£ç é‡å¤ç‡** | ~35% | <5% | â†“ 86% |
| **Services é‡å¤ç‡** | ~30% | <5% | â†“ 83% |
| **Routes é‡å¤ç‡** | ~43% | <5% | â†“ 88% |
| **æ¨¡å—å¹³å‡è¡Œæ•°** | 280 è¡Œ | <150 è¡Œ | â†“ 46% |
| **ClaudeSDK.js è¡Œæ•°** | 561 è¡Œ | <200 è¡Œ | â†“ 64% |
| **taskmaster.js è¡Œæ•°** | 1979 è¡Œ | <200 è¡Œ | â†“ 90% |
| **agent.js è¡Œæ•°** | 1257 è¡Œ | <150 è¡Œ | â†“ 88% |
| **git.js è¡Œæ•°** | 1127 è¡Œ | <150 è¡Œ | â†“ 87% |
| **JSONL è§£æé‡å¤** | 3 å¤„ | 1 å¤„ | â†“ 67% |
| **èŒè´£å•ä¸€æ€§** | ä½ | é«˜ | æ˜¾è‘—æ”¹å–„ |
| **åˆ†å±‚æ¸…æ™°åº¦** | ä½ | é«˜ | æ˜¾è‘—æ”¹å–„ |

### 2.2 é¢„æœŸæ”¶ç›Š

1. **ä»£ç å¯ç»´æŠ¤æ€§**
   - æ¶ˆé™¤ 35% çš„é‡å¤ä»£ç ï¼ˆçº¦ 7,200 è¡Œï¼‰
   - æ¸…æ™°çš„æ¨¡å—èŒè´£å’Œåˆ†å±‚æ¶æ„
   - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼
   - è·¯ç”±æ–‡ä»¶ç²¾ç®€ 60-80%

2. **æ‰©å±•æ€§**
   - æ–°å¢ AI ä»£ç†åªéœ€å®ç°æ¥å£
   - å®¹å™¨/éå®¹å™¨æ¨¡å¼é€æ˜åˆ‡æ¢
   - æ–°å¢ API ç«¯ç‚¹åªéœ€å®šä¹‰æ§åˆ¶å™¨å’Œè·¯ç”±
   - è·¯ç”±æŒ‰åŠŸèƒ½æ¨¡å—æ¸…æ™°ç»„ç»‡

3. **å¼€å‘æ•ˆç‡**
   - å‡å°‘è·¨æ–‡ä»¶æŸ¥æ‰¾æ—¶é—´
   - é™ä½å¼•å…¥ bug çš„é£é™©
   - æ¸…æ™°çš„åˆ†å±‚æ¶æ„ä¾¿äºåä½œ
   - ç»Ÿä¸€çš„å¼€å‘æ¨¡å¼é™ä½å­¦ä¹ æˆæœ¬

4. **æ¶æ„è´¨é‡**
   - ç¬¦åˆ MVC åˆ†å±‚æ¶æ„
   - è·¯ç”±å±‚è½»é‡åŒ–ï¼ˆå¹³å‡ <150 è¡Œï¼‰
   - æ§åˆ¶å™¨å±‚ç»Ÿä¸€ä¸šåŠ¡é€»è¾‘
   - æœåŠ¡å±‚ä¸“æ³¨ä¸šåŠ¡å®ç°

### 2.3 éœ€è¦æƒè¡¡çš„å› ç´ 

1. **é¡¹ç›®è§„æ¨¡**ï¼šé‡æ„éœ€è¦ 14-18 å‘¨ï¼ˆServices 10-13 å‘¨ + Routes 4-5 å‘¨ï¼‰
2. **é£é™©**ï¼šæ‰§è¡Œå±‚å’Œè·¯ç”±å±‚é‡æ„å±äºä¸­é«˜é£é™©
3. **èµ„æºæŠ•å…¥**ï¼šéœ€è¦å¤šä¸ªå¼€å‘å‘¨æœŸ
4. **å¤æ‚åº¦**ï¼šéœ€è¦å¼•å…¥æ–°çš„æ§åˆ¶å™¨å±‚æ¦‚å¿µ

### 2.4 è¯„ä¼°ç»“è®º

**âœ… æ­¤é‡æ„æ˜¯å€¼å¾—çš„**

ç†ç”±ï¼š
- æ•´ä½“ä»£ç é‡å¤ç‡ 35% è¿œè¶…åˆç†èŒƒå›´
- Routes å±‚é‡å¤ç‡ 43% å°¤ä¸ºä¸¥é‡
- è¶…å¤§è·¯ç”±æ–‡ä»¶ï¼ˆ1979 è¡Œï¼‰ä¸¥é‡å½±å“å¯ç»´æŠ¤æ€§
- è¿ååˆ†å±‚æ¶æ„ï¼Œè€¦åˆåº¦é«˜
- ç¼ºä¹ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼
- é‡æ„åæ”¶ç›Šæ˜æ˜¾ï¼Œé£é™©å¯æ§
- æ¸è¿›å¼é‡æ„å¯é™ä½é£é™©
- ç³»ç»Ÿå°šæœªæŠ•å…¥ä½¿ç”¨ï¼Œæ— éœ€è€ƒè™‘å‘åå…¼å®¹

---

## ä¸‰ã€é‡æ„æ–¹æ¡ˆè®¾è®¡

### 3.1 æ–°ç›®å½•ç»“æ„

```
services/
â”œâ”€â”€ core/                      # æ ¸å¿ƒæŠ½è±¡å±‚ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ interfaces/           # æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ IExecutionEngine.js     # æ‰§è¡Œå¼•æ“æ¥å£
â”‚   â”‚   â”œâ”€â”€ IFileOperations.js      # æ–‡ä»¶æ“ä½œæ¥å£
â”‚   â”‚   â”œâ”€â”€ ISessionManager.js      # ä¼šè¯ç®¡ç†æ¥å£
â”‚   â”‚   â””â”€â”€ IProjectDiscovery.js    # é¡¹ç›®å‘ç°æ¥å£
â”‚   â”œâ”€â”€ types/                # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ session-types.js        # ä¼šè¯ç›¸å…³ç±»å‹
â”‚   â”‚   â”œâ”€â”€ execution-types.js      # æ‰§è¡Œç›¸å…³ç±»å‹
â”‚   â”‚   â””â”€â”€ message-types.js        # æ¶ˆæ¯ç›¸å…³ç±»å‹
â”‚   â””â”€â”€ utils/                # é€šç”¨å·¥å…·
â”‚       â”œâ”€â”€ path-utils.js          # ç»Ÿä¸€è·¯å¾„å¤„ç†
â”‚       â”œâ”€â”€ jsonl-parser.js        # JSONL è§£æå™¨
â”‚       â””â”€â”€ message-filter.js      # æ¶ˆæ¯è¿‡æ»¤å™¨
â”‚
â”œâ”€â”€ execution/                 # æ‰§è¡Œå±‚ï¼ˆé‡æ„ï¼‰
â”‚   â”œâ”€â”€ engines/              # æ‰§è¡Œå¼•æ“å®ç°
â”‚   â”‚   â”œâ”€â”€ BaseExecutionEngine.js     # åŸºç¡€æ‰§è¡Œå¼•æ“
â”‚   â”‚   â”œâ”€â”€ NativeExecutionEngine.js   # æœ¬åœ°æ‰§è¡Œå¼•æ“
â”‚   â”‚   â””â”€â”€ ContainerExecutionEngine.js # å®¹å™¨æ‰§è¡Œå¼•æ“
â”‚   â”œâ”€â”€ claude/               # Claude æ‰§è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ ClaudeExecutor.js        # ç»Ÿä¸€ Claude æ‰§è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ SDKWrapper.js            # SDK åŒ…è£…å™¨
â”‚   â”‚   â””â”€â”€ OptionsMapper.js         # é€‰é¡¹æ˜ å°„å™¨
â”‚   â”œâ”€â”€ cursor/               # Cursor æ‰§è¡Œå™¨
â”‚   â”‚   â””â”€â”€ CursorExecutor.js
â”‚   â””â”€â”€ codex/                # Codex æ‰§è¡Œå™¨
â”‚       â””â”€â”€ CodexExecutor.js
â”‚
â”œâ”€â”€ files/                     # æ–‡ä»¶æ“ä½œå±‚ï¼ˆé‡æ„ï¼‰
â”‚   â”œâ”€â”€ adapters/             # æ–‡ä»¶æ“ä½œé€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ BaseFileAdapter.js       # åŸºç¡€æ–‡ä»¶é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ NativeFileAdapter.js     # æœ¬åœ°æ–‡ä»¶é€‚é…å™¨
â”‚   â”‚   â””â”€â”€ ContainerFileAdapter.js  # å®¹å™¨æ–‡ä»¶é€‚é…å™¨
â”‚   â”œâ”€â”€ operations/           # æ–‡ä»¶æ“ä½œå®ç°
â”‚   â”‚   â”œâ”€â”€ read.js                   # è¯»æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ write.js                  # å†™æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ tree.js                   # æ–‡ä»¶æ ‘
â”‚   â”‚   â””â”€â”€ stats.js                  # æ–‡ä»¶ç»Ÿè®¡
â”‚   â””â”€â”€ validators/           # è·¯å¾„éªŒè¯å™¨
â”‚       â””â”€â”€ path-validator.js
â”‚
â”œâ”€â”€ sessions/                  # ä¼šè¯ç®¡ç†å±‚ï¼ˆé‡æ„ï¼‰
â”‚   â”œâ”€â”€ managers/             # ä¼šè¯ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ BaseSessionManager.js     # åŸºç¡€ä¼šè¯ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ NativeSessionManager.js   # æœ¬åœ°ä¼šè¯ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ ContainerSessionManager.js # å®¹å™¨ä¼šè¯ç®¡ç†å™¨
â”‚   â”œâ”€â”€ parsers/              # ä¼šè¯è§£æå™¨
â”‚   â”‚   â”œâ”€â”€ JsonlParser.js            # JSONL è§£æå™¨ï¼ˆç»Ÿä¸€ï¼‰
â”‚   â”‚   â””â”€â”€ SessionGrouping.js        # ä¼šè¯åˆ†ç»„é€»è¾‘
â”‚   â””â”€â”€ storage/              # ä¼šè¯å­˜å‚¨
â”‚       â”œâ”€â”€ FileStorage.js            # æ–‡ä»¶å­˜å‚¨åŸºç±»
â”‚       â””â”€â”€ ContainerStorage.js       # å®¹å™¨å­˜å‚¨
â”‚
â”œâ”€â”€ projects/                  # é¡¹ç›®ç®¡ç†å±‚ï¼ˆé‡æ„ï¼‰
â”‚   â”œâ”€â”€ discovery/            # é¡¹ç›®å‘ç°
â”‚   â”‚   â”œâ”€â”€ BaseDiscovery.js          # åŸºç¡€å‘ç°å™¨
â”‚   â”‚   â”œâ”€â”€ ClaudeDiscovery.js        # Claude é¡¹ç›®å‘ç°
â”‚   â”‚   â”œâ”€â”€ CursorDiscovery.js        # Cursor é¡¹ç›®å‘ç°
â”‚   â”‚   â””â”€â”€ CodexDiscovery.js         # Codex é¡¹ç›®å‘ç°
â”‚   â”œâ”€â”€ config/               # é¡¹ç›®é…ç½®
â”‚   â”‚   â”œâ”€â”€ project-config.js
â”‚   â”‚   â”œâ”€â”€ cache.js
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â””â”€â”€ management/           # é¡¹ç›®ç®¡ç†æ“ä½œ
â”‚       â”œâ”€â”€ operations.js             # é¡¹ç›® CRUD
â”‚       â””â”€â”€ index.js
â”‚
â”œâ”€â”€ containers/                # å®¹å™¨é€‚é…å±‚ï¼ˆé‡æ„ï¼‰
â”‚   â”œâ”€â”€ core/                 # å®¹å™¨æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ DockerConnection.js
â”‚   â”‚   â”œâ”€â”€ ContainerConfig.js
â”‚   â”‚   â”œâ”€â”€ ContainerHealth.js
â”‚   â”‚   â”œâ”€â”€ ContainerStats.js
â”‚   â”‚   â”œâ”€â”€ ContainerCleanup.js
â”‚   â”‚   â””â”€â”€ ContainerLifecycle.js
â”‚   â”œâ”€â”€ adapters/             # å®¹å™¨é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ ExecutionAdapter.js      # æ‰§è¡Œé€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ FileAdapter.js           # æ–‡ä»¶é€‚é…å™¨
â”‚   â”‚   â””â”€â”€ SessionAdapter.js        # ä¼šè¯é€‚é…å™¨
â”‚   â””â”€â”€ utils/                # å®¹å™¨å·¥å…·
â”‚       â”œâ”€â”€ script-builder.js
â”‚       â””â”€â”€ message-transformer.js
â”‚
â”œâ”€â”€ workspace/                 # å·¥ä½œåŒºæœåŠ¡ï¼ˆä¿æŒï¼‰
â”‚   â”œâ”€â”€ path-validator.js
â”‚   â”œâ”€â”€ github-service.js
â”‚   â”œâ”€â”€ creator.js
â”‚   â””â”€â”€ index.js
â”‚
â””â”€â”€ index.js                   # ç»Ÿä¸€å¯¼å‡º
```

### 3.1.2 Routes å±‚æ–°ç»“æ„ï¼ˆå¼•å…¥æ§åˆ¶å™¨å±‚ï¼‰

```
routes/
â”œâ”€â”€ core/                      # æ ¸å¿ƒç³»ç»Ÿè·¯ç”±
â”‚   â”œâ”€â”€ auth.js                # è®¤è¯è·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â”œâ”€â”€ users.js               # ç”¨æˆ·ç®¡ç†è·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â””â”€â”€ settings.js            # ç³»ç»Ÿè®¾ç½®è·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚
â”œâ”€â”€ resources/                 # èµ„æºè·¯ç”±
â”‚   â”œâ”€â”€ projects.js            # é¡¹ç›®èµ„æºè·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â”œâ”€â”€ sessions.js            # ä¼šè¯èµ„æºè·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â”œâ”€â”€ files.js               # æ–‡ä»¶èµ„æºè·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â””â”€â”€ git.js                 # Git èµ„æºè·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚
â”œâ”€â”€ integrations/              # ç¬¬ä¸‰æ–¹é›†æˆè·¯ç”±
â”‚   â”œâ”€â”€ ai-providers/
â”‚   â”‚   â”œâ”€â”€ claude.js          # Claude è·¯ç”±ï¼ˆ<80 è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ cursor.js          # Cursor è·¯ç”±ï¼ˆ<80 è¡Œï¼‰
â”‚   â”‚   â””â”€â”€ codex.js           # Codex è·¯ç”±ï¼ˆ<80 è¡Œï¼‰
â”‚   â”œâ”€â”€ mcp.js                 # MCP è·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â”œâ”€â”€ taskmaster.js          # TaskMaster è·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚   â””â”€â”€ agent.js               # Agent API è·¯ç”±ï¼ˆ<100 è¡Œï¼‰
â”‚
â”œâ”€â”€ tools/                     # å·¥å…·è·¯ç”±
â”‚   â”œâ”€â”€ commands.js            # å‘½ä»¤ç³»ç»Ÿè·¯ç”±ï¼ˆ<80 è¡Œï¼‰
â”‚   â”œâ”€â”€ uploads.js             # ä¸Šä¼ è·¯ç”±ï¼ˆ<80 è¡Œï¼‰
â”‚   â””â”€â”€ system.js              # ç³»ç»Ÿå·¥å…·è·¯ç”±ï¼ˆ<80 è¡Œï¼‰
â”‚
â””â”€â”€ index.js                   # è·¯ç”±æ±‡æ€»

controllers/                   # æ§åˆ¶å™¨å±‚ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ AuthController.js      # è®¤è¯æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ UserController.js      # ç”¨æˆ·æ§åˆ¶å™¨
â”‚   â””â”€â”€ SettingsController.js  # è®¾ç½®æ§åˆ¶å™¨
â”‚
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ ProjectController.js   # é¡¹ç›®æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ SessionController.js   # ä¼šè¯æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ FileController.js      # æ–‡ä»¶æ§åˆ¶å™¨
â”‚   â””â”€â”€ GitController.js       # Git æ§åˆ¶å™¨
â”‚
â”œâ”€â”€ integrations/
â”‚   â”œâ”€â”€ ClaudeController.js    # Claude æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ CursorController.js    # Cursor æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ CodexController.js     # Codex æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ MCPController.js       # MCP æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ TaskMasterController.js # TaskMaster æ§åˆ¶å™¨
â”‚   â””â”€â”€ AgentController.js     # Agent æ§åˆ¶å™¨
â”‚
â””â”€â”€ tools/
    â”œâ”€â”€ CommandController.js   # å‘½ä»¤æ§åˆ¶å™¨
    â”œâ”€â”€ UploadController.js    # ä¸Šä¼ æ§åˆ¶å™¨
    â””â”€â”€ SystemController.js    # ç³»ç»Ÿæ§åˆ¶å™¨

middleware/                    # ä¸­é—´ä»¶å±‚ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ auth.js                    # ç»Ÿä¸€è®¤è¯ä¸­é—´ä»¶
â”œâ”€â”€ validation.js              # è¯·æ±‚éªŒè¯ä¸­é—´ä»¶
â”œâ”€â”€ error-handler.js           # ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”œâ”€â”€ response-formatter.js      # å“åº”æ ¼å¼åŒ–ä¸­é—´ä»¶
â””â”€â”€ index.js                   # ä¸­é—´ä»¶æ±‡æ€»
```

### 3.1.3 åˆ†å±‚æ¶æ„è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Routes Layer                         â”‚
â”‚  (ä»…å¤„ç† HTTP è¯·æ±‚/å“åº”ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘)                       â”‚
â”‚  - å‚æ•°æå–                                                   â”‚
â”‚  - è°ƒç”¨æ§åˆ¶å™¨                                                 â”‚
â”‚  - è¿”å›å“åº”                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Controllers Layer                        â”‚
â”‚  (åè°ƒä¸šåŠ¡é€»è¾‘ï¼Œç¼–æ’æœåŠ¡è°ƒç”¨)                                 â”‚
â”‚  - è¯·æ±‚éªŒè¯                                                   â”‚
â”‚  - è°ƒç”¨æœåŠ¡å±‚                                                 â”‚
â”‚  - æ•°æ®è½¬æ¢                                                   â”‚
â”‚  - é”™è¯¯å¤„ç†                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Services Layer                          â”‚
â”‚  (å®ç°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘)                                           â”‚
â”‚  - AI æ‰§è¡Œ                                                    â”‚
â”‚  - æ–‡ä»¶æ“ä½œ                                                   â”‚
â”‚  - ä¼šè¯ç®¡ç†                                                   â”‚
â”‚  - é¡¹ç›®ç®¡ç†                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Core / Utils Layer                        â”‚
â”‚  (é€šç”¨å·¥å…·å’ŒåŸºç¡€è®¾æ–½)                                         â”‚
â”‚  - è·¯å¾„å¤„ç†                                                   â”‚
â”‚  - JSONL è§£æ                                                 â”‚
â”‚  - é”™è¯¯å¤„ç†                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### 3.2 æ ¸å¿ƒæŠ½è±¡æ¥å£

#### 3.2.1 æ‰§è¡Œå¼•æ“æ¥å£

```javascript
/**
 * core/interfaces/IExecutionEngine.js
 *
 * æ‰§è¡Œå¼•æ“æ¥å£ - ç»Ÿä¸€å®¹å™¨å’Œéå®¹å™¨æ‰§è¡Œæ¨¡å¼
 */
export class IExecutionEngine {
  /**
   * æ‰§è¡Œå‘½ä»¤
   * @param {string} command - å‘½ä»¤
   * @param {Object} options - é€‰é¡¹
   * @param {Object} writer - WebSocket å†™å…¥å™¨
   * @returns {Promise<Object>} æ‰§è¡Œç»“æœ
   */
  async execute(command, options, writer) {
    throw new Error('Not implemented');
  }

  /**
   * ä¸­æ­¢æ‰§è¡Œ
   * @param {string} sessionId - ä¼šè¯ ID
   * @returns {Promise<boolean>}
   */
  async abort(sessionId) {
    throw new Error('Not implemented');
  }

  /**
   * æ£€æŸ¥ä¼šè¯æ˜¯å¦æ´»åŠ¨
   * @param {string} sessionId - ä¼šè¯ ID
   * @returns {boolean}
   */
  isSessionActive(sessionId) {
    throw new Error('Not implemented');
  }

  /**
   * è·å–æ´»åŠ¨ä¼šè¯åˆ—è¡¨
   * @returns {Array<string>}
   */
  getActiveSessions() {
    throw new Error('Not implemented');
  }
}
```

#### 3.2.2 æ–‡ä»¶æ“ä½œæ¥å£

```javascript
/**
 * core/interfaces/IFileOperations.js
 *
 * æ–‡ä»¶æ“ä½œæ¥å£ - ç»Ÿä¸€å®¹å™¨å’Œéå®¹å™¨æ–‡ä»¶æ“ä½œ
 */
export class IFileOperations {
  /**
   * è¯»å–æ–‡ä»¶
   * @param {string} filePath - æ–‡ä»¶è·¯å¾„
   * @param {Object} options - é€‰é¡¹
   * @returns {Promise<{content: string, path: string}>}
   */
  async readFile(filePath, options) {
    throw new Error('Not implemented');
  }

  /**
   * å†™å…¥æ–‡ä»¶
   * @param {string} filePath - æ–‡ä»¶è·¯å¾„
   * @param {string} content - æ–‡ä»¶å†…å®¹
   * @param {Object} options - é€‰é¡¹
   * @returns {Promise<{success: boolean, path: string}>}
   */
  async writeFile(filePath, content, options) {
    throw new Error('Not implemented');
  }

  /**
   * è·å–æ–‡ä»¶æ ‘
   * @param {string} dirPath - ç›®å½•è·¯å¾„
   * @param {Object} options - é€‰é¡¹
   * @returns {Promise<Array>}
   */
  async getFileTree(dirPath, options) {
    throw new Error('Not implemented');
  }

  /**
   * è·å–æ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯
   * @param {string} filePath - æ–‡ä»¶è·¯å¾„
   * @param {Object} options - é€‰é¡¹
   * @returns {Promise<Object>}
   */
  async getFileStats(filePath, options) {
    throw new Error('Not implemented');
  }

  /**
   * åˆ é™¤æ–‡ä»¶
   * @param {string} filePath - æ–‡ä»¶è·¯å¾„
   * @param {Object} options - é€‰é¡¹
   * @returns {Promise<{success: boolean}>}
   */
  async deleteFile(filePath, options) {
    throw new Error('Not implemented');
  }
}
```

#### 3.2.3 ä¼šè¯ç®¡ç†æ¥å£

```javascript
/**
 * core/interfaces/ISessionManager.js
 *
 * ä¼šè¯ç®¡ç†æ¥å£ - ç»Ÿä¸€å®¹å™¨å’Œéå®¹å™¨ä¼šè¯ç®¡ç†
 */
export class ISessionManager {
  /**
   * è·å–é¡¹ç›®ä¼šè¯åˆ—è¡¨
   * @param {string} projectIdentifier - é¡¹ç›®æ ‡è¯†
   * @param {number} limit - æ•°é‡é™åˆ¶
   * @param {number} offset - åç§»é‡
   * @returns {Promise<Object>} ä¼šè¯åˆ—è¡¨å’Œåˆ†é¡µä¿¡æ¯
   */
  async getSessions(projectIdentifier, limit, offset) {
    throw new Error('Not implemented');
  }

  /**
   * è·å–ä¼šè¯æ¶ˆæ¯
   * @param {string} projectIdentifier - é¡¹ç›®æ ‡è¯†
   * @param {string} sessionId - ä¼šè¯ ID
   * @param {number|null} limit - æ•°é‡é™åˆ¶
   * @param {number} offset - åç§»é‡
   * @returns {Promise<Object|Array>} æ¶ˆæ¯åˆ—è¡¨
   */
  async getSessionMessages(projectIdentifier, sessionId, limit, offset) {
    throw new Error('Not implemented');
  }

  /**
   * åˆ é™¤ä¼šè¯
   * @param {string} projectIdentifier - é¡¹ç›®æ ‡è¯†
   * @param {string} sessionId - ä¼šè¯ ID
   * @returns {Promise<boolean>}
   */
  async deleteSession(projectIdentifier, sessionId) {
    throw new Error('Not implemented');
  }
}
```

#### 3.2.4 é¡¹ç›®å‘ç°æ¥å£

```javascript
/**
 * core/interfaces/IProjectDiscovery.js
 *
 * é¡¹ç›®å‘ç°æ¥å£ - ç»Ÿä¸€å¤šç§ AI ä»£ç†çš„é¡¹ç›®å‘ç°
 */
export class IProjectDiscovery {
  /**
   * è·å–é¡¹ç›®åˆ—è¡¨
   * @returns {Promise<Array>}
   */
  async getProjects() {
    throw new Error('Not implemented');
  }

  /**
   * è·å–é¡¹ç›®ä¼šè¯
   * @param {string} projectIdentifier - é¡¹ç›®æ ‡è¯†
   * @param {number} limit - æ•°é‡é™åˆ¶
   * @param {number} offset - åç§»é‡
   * @returns {Promise<Object>}
   */
  async getProjectSessions(projectIdentifier, limit, offset) {
    throw new Error('Not implemented');
  }

  /**
   * æ£€æŸ¥é¡¹ç›®æ˜¯å¦ä¸ºç©º
   * @param {string} projectIdentifier - é¡¹ç›®æ ‡è¯†
   * @returns {Promise<boolean>}
   */
  async isProjectEmpty(projectIdentifier) {
    throw new Error('Not implemented');
  }
}
```

### 3.3 è®¾è®¡æ¨¡å¼

#### 3.3.1 ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰

ç”¨äºæ‰§è¡Œå¼•æ“å’Œæ–‡ä»¶æ“ä½œçš„å®¹å™¨/éå®¹å™¨åˆ‡æ¢ï¼š

```javascript
// æ‰§è¡Œå¼•æ“å·¥å‚
class ExecutionEngineFactory {
  static create() {
    if (CONTAINER_MODE === '1') {
      return new ContainerExecutionEngine();
    }
    return new NativeExecutionEngine();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const engine = ExecutionEngineFactory.create();
await engine.execute(command, options, writer);
```

#### 3.3.2 é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰

ç”¨äºå®¹å™¨æ¨¡å—é€‚é…åˆ°ç»Ÿä¸€æ¥å£ï¼š

```javascript
// å®¹å™¨æ–‡ä»¶é€‚é…å™¨
class ContainerFileAdapter extends IFileOperations {
  constructor(userId) {
    this.userId = userId;
  }

  async readFile(filePath, options) {
    // è°ƒç”¨ container/file æ¨¡å—
    return await readFileFromContainer(this.userId, filePath, options);
  }
}
```

#### 3.3.3 æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Method Patternï¼‰

ç”¨äºä¼šè¯ç®¡ç†å™¨çš„åŸºç¡€æµç¨‹ï¼š

```javascript
class BaseSessionManager {
  async getSessions(projectIdentifier, limit, offset) {
    // æ¨¡æ¿æ–¹æ³•å®šä¹‰æµç¨‹
    const sessions = await this.fetchSessions(projectIdentifier);
    const grouped = this.groupSessions(sessions);
    return this.paginate(grouped, limit, offset);
  }

  async fetchSessions(projectIdentifier) {
    throw new Error('Must implement');
  }

  groupSessions(sessions) {
    // ç»Ÿä¸€çš„åˆ†ç»„é€»è¾‘
  }

  paginate(sessions, limit, offset) {
    // ç»Ÿä¸€çš„åˆ†é¡µé€»è¾‘
  }
}
```

---

## å››ã€è¿ç§»è®¡åˆ’

### 4.1 é˜¶æ®µæ¦‚è§ˆ

| é˜¶æ®µ | æ—¶é—´ | ç›®æ ‡ | é£é™© | ä¾èµ– |
|------|------|------|------|------|
| **1. åˆ›å»ºæ ¸å¿ƒæŠ½è±¡å±‚** | 1-2 å‘¨ | å»ºç«‹æ¥å£å’Œå·¥å…· | ä½ | æ—  |
| **2. é‡æ„æ‰§è¡Œå±‚** | 2 å‘¨ | ç»Ÿä¸€ Claude/Cursor/Codex | ä¸­ | é˜¶æ®µ 1 |
| **3. é‡æ„æ–‡ä»¶æ“ä½œå±‚** | 1-2 å‘¨ | ç»Ÿä¸€å®¹å™¨/éå®¹å™¨æ–‡ä»¶æ“ä½œ | ä½ | é˜¶æ®µ 1 |
| **4. é‡æ„ä¼šè¯ç®¡ç†å±‚** | 2 å‘¨ | ç»Ÿä¸€ä¼šè¯ç®¡ç†ï¼Œæ¶ˆé™¤é‡å¤ | ä¸­ | é˜¶æ®µ 1, 3 |
| **5. é‡æ„é¡¹ç›®ç®¡ç†å±‚** | 1-2 å‘¨ | ç»Ÿä¸€é¡¹ç›®å‘ç° | ä½ | é˜¶æ®µ 1 |
| **6. å®¹å™¨é€‚é…å±‚é‡æ„** | 1 å‘¨ | ä¼˜åŒ–å®¹å™¨æ¨¡å— | ä½ | é˜¶æ®µ 1, 2, 3 |
| **7. åˆ›å»ºä¸­é—´ä»¶å±‚** | 1 å‘¨ | ç»Ÿä¸€è®¤è¯ã€é”™è¯¯å¤„ç†ã€å“åº”æ ¼å¼ | ä½ | æ—  |
| **8. å¼•å…¥æ§åˆ¶å™¨å±‚** | 2 å‘¨ | å°†ä¸šåŠ¡é€»è¾‘ä»è·¯ç”±è¿ç§»åˆ°æ§åˆ¶å™¨ | ä¸­ | é˜¶æ®µ 7 |
| **9. é‡æ„è·¯ç”±å±‚** | 1-2 å‘¨ | é‡ç»„è·¯ç”±ç»“æ„ï¼Œç²¾ç®€è·¯ç”±æ–‡ä»¶ | ä½ | é˜¶æ®µ 8 |
| **10. æ¸…ç†å’Œä¼˜åŒ–** | 1 å‘¨ | åˆ é™¤æ—§ä»£ç ï¼Œä¼˜åŒ– | ä½ | æ‰€æœ‰ |

**æ€»æ—¶é—´**ï¼š14-18 å‘¨

### 4.2 é˜¶æ®µ 1ï¼šåˆ›å»ºæ ¸å¿ƒæŠ½è±¡å±‚

**ç›®æ ‡**ï¼šå»ºç«‹æ¥å£å’Œé€šç”¨å·¥å…·ï¼Œä¸ç ´åç°æœ‰åŠŸèƒ½

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `core/interfaces/` ç›®å½•å’Œæ‰€æœ‰æ¥å£å®šä¹‰
2. åˆ›å»º `core/types/` ç›®å½•å’Œç±»å‹å®šä¹‰
3. å®ç°é€šç”¨å·¥å…·ç±»ï¼š
   - `core/utils/jsonl-parser.js`ï¼ˆåˆå¹¶é‡å¤çš„ JSONL è§£æé€»è¾‘ï¼‰
   - `core/utils/path-utils.js`ï¼ˆç»Ÿä¸€è·¯å¾„å¤„ç†ï¼‰
   - `core/utils/message-filter.js`ï¼ˆç»Ÿä¸€æ¶ˆæ¯è¿‡æ»¤é€»è¾‘ï¼‰
4. ç¼–å†™å•å…ƒæµ‹è¯•éªŒè¯å·¥å…·ç±»æ­£ç¡®æ€§
5. æ›´æ–° `services/index.js` å¯¼å‡ºæ–°æ¥å£

**éªŒæ”¶æ ‡å‡†**ï¼š
- [x] æ‰€æœ‰æ¥å£å®šä¹‰å®Œæ•´
- [x] å·¥å…·ç±»é€šè¿‡å•å…ƒæµ‹è¯•
- [x] ç°æœ‰åŠŸèƒ½ä¸å—å½±å“
- [ ] TypeScript ç¼–è¯‘é€šè¿‡

### 4.3 é˜¶æ®µ 2ï¼šé‡æ„æ‰§è¡Œå±‚

**ç›®æ ‡**ï¼šç»Ÿä¸€ Claude/Cursor/Codex æ‰§è¡Œé€»è¾‘

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `execution/` ç›®å½•ç»“æ„
2. å®ç° `BaseExecutionEngine` åŸºç±»
3. æ‹†åˆ† `claude/ClaudeSDK.js` (561 è¡Œ)ï¼š
   - æå– SDK è°ƒç”¨åˆ° `SDKWrapper.js`
   - æå–é€‰é¡¹æ˜ å°„åˆ° `OptionsMapper.js`
   - åˆ›å»º `ClaudeExecutor.js`
4. è¿ç§» `container/claude/ClaudeQuery.js` åˆ° `execution/claude/`
5. åˆ›å»º `NativeExecutionEngine` å’Œ `ContainerExecutionEngine`
6. è¿ç§» Cursor æ‰§è¡Œé€»è¾‘
7. è¿ç§» Codex æ‰§è¡Œé€»è¾‘
8. æ›´æ–°è·¯ç”±ä»¥ä½¿ç”¨æ–°çš„æ‰§è¡Œå™¨

**éªŒæ”¶æ ‡å‡†**ï¼š
- [x] æ‰€æœ‰ AI ä»£ç†ä½¿ç”¨ç»Ÿä¸€æ¥å£
- [x] æ‰§è¡Œé€»è¾‘æ¨¡å—åŒ–ï¼Œå•ä¸€èŒè´£
- [x] åŠŸèƒ½æµ‹è¯•é€šè¿‡

### 4.4 é˜¶æ®µ 3ï¼šé‡æ„æ–‡ä»¶æ“ä½œå±‚

**ç›®æ ‡**ï¼šç»Ÿä¸€å®¹å™¨å’Œéå®¹å™¨æ–‡ä»¶æ“ä½œ

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `files/` ç›®å½•ç»“æ„
2. å®ç° `BaseFileAdapter` åŸºç±»
3. å®ç° `NativeFileAdapter`ï¼ˆæ•´åˆæœ¬åœ°æ–‡ä»¶æ“ä½œï¼‰
4. å®ç° `ContainerFileAdapter`ï¼ˆæ•´åˆ `container/file/` æ“ä½œï¼‰
5. åˆ›å»ºç»Ÿä¸€æ–‡ä»¶æ“ä½œæœåŠ¡
6. æ›´æ–°è·¯ç”±ä»¥ä½¿ç”¨æ–°çš„æ–‡ä»¶æ“ä½œ

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ–‡ä»¶æ“ä½œé€šè¿‡é€‚é…å™¨æ¨¡å¼ç»Ÿä¸€
- [ ] å®¹å™¨/éå®¹å™¨æ¨¡å¼é€æ˜åˆ‡æ¢
- [ ] å®‰å…¨éªŒè¯å®Œæ•´
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡

### 4.5 é˜¶æ®µ 4ï¼šé‡æ„ä¼šè¯ç®¡ç†å±‚

**ç›®æ ‡**ï¼šç»Ÿä¸€ä¼šè¯ç®¡ç†ï¼Œæ¶ˆé™¤é‡å¤ä»£ç 

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `sessions/` ç›®å½•ç»“æ„
2. å®ç° `JsonlParser`ï¼ˆç»Ÿä¸€ JSONL è§£æï¼Œæ¶ˆé™¤ 95% é‡å¤ï¼‰
3. å®ç° `SessionGrouping`ï¼ˆç»Ÿä¸€ä¼šè¯åˆ†ç»„é€»è¾‘ï¼‰
4. å®ç° `BaseSessionManager` åŸºç±»
5. å®ç° `NativeSessionManager`ï¼ˆæœ¬åœ°ä¼šè¯ï¼‰
6. å®ç° `ContainerSessionManager`ï¼ˆå®¹å™¨ä¼šè¯ï¼‰
7. æ›´æ–°è·¯ç”±ä»¥ä½¿ç”¨æ–°çš„ä¼šè¯ç®¡ç†å™¨
8. åˆ é™¤æ—§çš„é‡å¤ä»£ç 

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] JSONL è§£æé€»è¾‘æ— é‡å¤
- [ ] ä¼šè¯ç®¡ç†ç»Ÿä¸€æ¥å£
- [ ] å®¹å™¨/éå®¹å™¨æ¨¡å¼é€æ˜åˆ‡æ¢
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡

### 4.6 é˜¶æ®µ 5ï¼šé‡æ„é¡¹ç›®ç®¡ç†å±‚

**ç›®æ ‡**ï¼šç»Ÿä¸€å¤šç§ AI ä»£ç†çš„é¡¹ç›®å‘ç°

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `projects/discovery/` ç›®å½•
2. å®ç° `BaseDiscovery` åŸºç±»
3. åˆ†åˆ«å®ç° Claude/Cursor/Codex é¡¹ç›®å‘ç°å™¨
4. é‡æ„ `project/claude/projects.js` ä½¿ç”¨æ–°çš„å‘ç°å™¨
5. æ›´æ–°è·¯ç”±ä»¥ä½¿ç”¨æ–°çš„é¡¹ç›®å‘ç°
6. åˆ é™¤æ—§çš„é‡å¤ä»£ç 

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] é¡¹ç›®å‘ç°é€»è¾‘æ¨¡å—åŒ–
- [ ] æ˜“äºæ‰©å±•æ–°çš„ AI ä»£ç†
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡

### 4.7 é˜¶æ®µ 6ï¼šå®¹å™¨é€‚é…å±‚é‡æ„

**ç›®æ ‡**ï¼šä¼˜åŒ–å®¹å™¨æ¨¡å—ï¼Œæä¾›é€‚é…å™¨

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `containers/adapters/` ç›®å½•
2. å®ç°æ‰§è¡Œé€‚é…å™¨
3. å®ç°æ–‡ä»¶é€‚é…å™¨
4. å®ç°ä¼šè¯é€‚é…å™¨
5. ä¼˜åŒ– `containers/core/` æ¨¡å—å¯¼å…¥
6. æ›´æ–°å¯¼å…¥è·¯å¾„

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] å®¹å™¨æ¨¡å—æ¸…æ™°åˆ†å±‚
- [ ] é€‚é…å™¨æ¨¡å¼ç»Ÿä¸€æ¥å£
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡

### 4.7 é˜¶æ®µ 6ï¼šå®¹å™¨é€‚é…å±‚é‡æ„

**ç›®æ ‡**ï¼šä¼˜åŒ–å®¹å™¨æ¨¡å—ï¼Œæä¾›é€‚é…å™¨

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `containers/adapters/` ç›®å½•
2. å®ç°æ‰§è¡Œé€‚é…å™¨
3. å®ç°æ–‡ä»¶é€‚é…å™¨
4. å®ç°ä¼šè¯é€‚é…å™¨
5. ä¼˜åŒ– `containers/core/` æ¨¡å—å¯¼å…¥
6. æ›´æ–°å¯¼å…¥è·¯å¾„

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] å®¹å™¨æ¨¡å—æ¸…æ™°åˆ†å±‚
- [ ] é€‚é…å™¨æ¨¡å¼ç»Ÿä¸€æ¥å£
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡

### 4.8 é˜¶æ®µ 7ï¼šåˆ›å»ºä¸­é—´ä»¶å±‚

**ç›®æ ‡**ï¼šç»Ÿä¸€è®¤è¯ã€é”™è¯¯å¤„ç†ã€å“åº”æ ¼å¼

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `middleware/` ç›®å½•
2. å®ç°ç»Ÿä¸€è®¤è¯ä¸­é—´ä»¶ï¼ˆåˆå¹¶ authenticateToken, validateExternalApiKeyï¼‰
3. å®ç°ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
4. å®ç°å“åº”æ ¼å¼åŒ–ä¸­é—´ä»¶
5. å®ç°è¯·æ±‚éªŒè¯ä¸­é—´ä»¶
6. åˆ›å»ºä¸­é—´ä»¶æ±‡æ€»æ–‡ä»¶

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ‰€æœ‰è®¤è¯é€»è¾‘ç»Ÿä¸€
- [ ] é”™è¯¯å“åº”æ ¼å¼ä¸€è‡´
- [ ] è·¯ç”±æ–‡ä»¶å¯ä½¿ç”¨ä¸­é—´ä»¶

### 4.9 é˜¶æ®µ 8ï¼šå¼•å…¥æ§åˆ¶å™¨å±‚

**ç›®æ ‡**ï¼šå°†ä¸šåŠ¡é€»è¾‘ä»è·¯ç”±è¿ç§»åˆ°æ§åˆ¶å™¨

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ›å»º `controllers/` ç›®å½•ç»“æ„
2. å®ç°æ ¸å¿ƒæ§åˆ¶å™¨ï¼ˆAuth, User, Settingsï¼‰
3. å®ç°èµ„æºæ§åˆ¶å™¨ï¼ˆProject, Session, File, Gitï¼‰
4. å®ç°é›†æˆæ§åˆ¶å™¨ï¼ˆClaude, Cursor, Codex, MCP, TaskMaster, Agentï¼‰
5. å®ç°å·¥å…·æ§åˆ¶å™¨ï¼ˆCommand, Upload, Systemï¼‰
6. å°†è·¯ç”±ä¸­çš„ä¸šåŠ¡é€»è¾‘è¿ç§»åˆ°å¯¹åº”æ§åˆ¶å™¨
7. è§£å†³è·¯ç”±ç›´æ¥è®¿é—®æ•°æ®åº“çš„é—®é¢˜ï¼ˆé€šè¿‡æœåŠ¡å±‚ï¼‰

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ‰€æœ‰ä¸šåŠ¡é€»è¾‘åœ¨æ§åˆ¶å™¨ä¸­
- [ ] è·¯ç”±æ–‡ä»¶ä»…å¤„ç† HTTP è¯·æ±‚/å“åº”
- [ ] æ§åˆ¶å™¨å¹³å‡è¡Œæ•° <200 è¡Œ
- [ ] æ— ç›´æ¥æ•°æ®åº“è®¿é—®

### 4.10 é˜¶æ®µ 9ï¼šé‡æ„è·¯ç”±å±‚

**ç›®æ ‡**ï¼šé‡ç»„è·¯ç”±ç»“æ„ï¼Œç²¾ç®€è·¯ç”±æ–‡ä»¶

**ä»»åŠ¡æ¸…å•**ï¼š
1. æŒ‰åŠŸèƒ½é‡ç»„è·¯ç”±ç›®å½•ï¼ˆcore/, resources/, integrations/, tools/ï¼‰
2. ç²¾ç®€è·¯ç”±æ–‡ä»¶ï¼Œç§»é™¤ä¸šåŠ¡é€»è¾‘
3. åˆå¹¶é‡å¤åŠŸèƒ½ï¼ˆMCPã€è®¤è¯ã€æ–‡ä»¶ï¼‰
4. ç»Ÿä¸€è·¯ç”±å‘½åè§„èŒƒï¼ˆRESTfulï¼‰
5. æ›´æ–°è·¯ç”±æŒ‚è½½é€»è¾‘
6. ä¼˜åŒ–ä¸­é—´ä»¶ä½¿ç”¨

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] è·¯ç”±æ–‡ä»¶å¹³å‡è¡Œæ•° <100 è¡Œ
- [ ] æ— ä¸šåŠ¡é€»è¾‘æ³„æ¼
- [ ] è·¯ç”±ç»„ç»‡æ¸…æ™°
- [ ] RESTful è§„èŒƒç¬¦åˆ

### 4.11 é˜¶æ®µ 10ï¼šæ¸…ç†å’Œä¼˜åŒ–

**ç›®æ ‡**ï¼šåˆ é™¤æ—§ä»£ç ï¼Œä¼˜åŒ–æ€§èƒ½

**ä»»åŠ¡æ¸…å•**ï¼š
1. åˆ é™¤æ—§çš„é‡å¤ä»£ç 
2. æ¸…ç†æœªä½¿ç”¨çš„å¯¼å…¥
3. ä¼˜åŒ–æ¨¡å—ä¾èµ–
4. æ›´æ–°æ–‡æ¡£
5. æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
6. ä»£ç å®¡æŸ¥

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] ä»£ç æ— é‡å¤
- [ ] ä¾èµ–æ¸…æ™°
- [ ] æ–‡æ¡£å®Œæ•´
- [ ] æ€§èƒ½æ— æ˜æ˜¾ä¸‹é™

---

## äº”ã€é£é™©è¯„ä¼°ä¸ç¼“è§£

### 5.1 é£é™©çŸ©é˜µ

| é£é™© | å½±å“ | æ¦‚ç‡ | é£é™©ç­‰çº§ | ç¼“è§£æªæ–½ |
|------|------|------|----------|----------|
| æ‰§è¡Œå±‚é‡æ„å¯¼è‡´åŠŸèƒ½å›å½’ | é«˜ | ä¸­ | ğŸ”´ é«˜ | åˆ†æ­¥è¿ç§»ï¼Œå…¨é¢æµ‹è¯•ï¼Œå……åˆ†éªŒè¯ |
| ä¼šè¯è§£æåˆå¹¶å¯¼è‡´è¾¹ç¼˜é—®é¢˜ | ä¸­ | ä¸­ | ğŸŸ¡ ä¸­ | è¯¦ç»†æµ‹è¯•ï¼Œå¯¹æ¯”éªŒè¯ï¼Œå•å…ƒæµ‹è¯•è¦†ç›– |
| å®¹å™¨/éå®¹å™¨åˆ‡æ¢ä¸ä¸€è‡´ | é«˜ | ä½ | ğŸŸ¡ ä¸­ | æ˜ç¡®çš„æ¨¡å¼åˆ‡æ¢æµ‹è¯•ï¼Œé›†æˆæµ‹è¯•è¦†ç›– |
| é€‚é…å™¨å±‚å¼•å…¥æ€§èƒ½å¼€é”€ | ä¸­ | ä½ | ğŸŸ¢ ä½ | æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œä¼˜åŒ–å®ç° |
| æ¨¡å—ä¾èµ–å¤æ‚å¯¼è‡´å¾ªç¯ä¾èµ– | ä¸­ | ä¸­ | ğŸŸ¡ ä¸­ | ä¾èµ–å›¾è®¾è®¡ï¼Œä¾èµ–æ³¨å…¥ï¼Œæ£€æµ‹å·¥å…· |
| æ§åˆ¶å™¨å±‚å¼•å…¥å¯¼è‡´æ¥å£å˜æ›´ | ä¸­ | ä¸­ | ğŸŸ¡ ä¸­ | æ˜ç¡®æ§åˆ¶å™¨æ¥å£ï¼Œå……åˆ†æµ‹è¯• |
| è·¯ç”±é‡ç»„å¯¼è‡´ API ç ´å | é«˜ | ä¸­ | ğŸ”´ é«˜ | API æ–‡æ¡£å¯¹æ¯”ï¼Œé›†æˆæµ‹è¯•è¦†ç›– |
| ä¸šåŠ¡é€»è¾‘è¿ç§»å¯¼è‡´é—æ¼ | é«˜ | ä¸­ | ğŸ”´ é«˜ | è¯¦ç»†æ¸…å•ï¼Œé€ä¸€éªŒè¯ï¼Œå›å½’æµ‹è¯• |

### 5.2 é«˜é£é™©é¡¹è¯¦ç»†ç¼“è§£

#### é£é™© 1ï¼šæ‰§è¡Œå±‚é‡æ„å¯¼è‡´åŠŸèƒ½å›å½’

**å½±å“**ï¼šæ ¸å¿ƒ AI æ‰§è¡ŒåŠŸèƒ½å—å½±å“

**ç¼“è§£æªæ–½**ï¼š
1. **åˆ†é˜¶æ®µè¿ç§»**ï¼šä¸€æ¬¡è¿ç§»ä¸€ä¸ª AI ä»£ç†
2. **å…¨é¢æµ‹è¯•**ï¼šå•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•
3. **ç›‘æ§å‘Šè­¦**ï¼šå…³é”®æŒ‡æ ‡ç›‘æ§ï¼ŒåŠæ—¶å‘ç°é—®é¢˜

#### é£é™© 2ï¼šä¼šè¯è§£æåˆå¹¶å¯¼è‡´è¾¹ç¼˜æƒ…å†µ

**å½±å“**ï¼šä¼šè¯å†å²æ˜¾ç¤ºé”™è¯¯æˆ–ä¸¢å¤±

**ç¼“è§£æªæ–½**ï¼š
1. **è¯¦ç»†å•å…ƒæµ‹è¯•**ï¼šè¦†ç›–å„ç§ JSONL æ ¼å¼
2. **å¯¹æ¯”æµ‹è¯•**ï¼šä¸ç°æœ‰è§£æç»“æœå¯¹æ¯”éªŒè¯
3. **å……åˆ†éªŒè¯**ï¼šä½¿ç”¨ç°æœ‰ session æ•°æ®è¿›è¡ŒéªŒè¯

#### é£é™© 3ï¼šæ§åˆ¶å™¨å±‚å¼•å…¥å¯¼è‡´ä¸šåŠ¡é€»è¾‘é—æ¼

**å½±å“**ï¼šä¸šåŠ¡é€»è¾‘è¿ç§»è¿‡ç¨‹ä¸­é—æ¼å…³é”®åŠŸèƒ½

**ç¼“è§£æªæ–½**ï¼š
1. **è¯¦ç»†è¿ç§»æ¸…å•**ï¼šé€ä¸€åˆ—å‡ºæ¯ä¸ªè·¯ç”±æ–‡ä»¶çš„æ‰€æœ‰åŠŸèƒ½ç‚¹
2. **å¯¹æ¯”æµ‹è¯•**ï¼šè¿ç§»å‰ååŠŸèƒ½å¯¹æ¯”
3. **å›å½’æµ‹è¯•**ï¼šå®Œæ•´çš„ç«¯åˆ°ç«¯æµ‹è¯•è¦†ç›–

#### é£é™© 4ï¼šè·¯ç”±é‡ç»„å¯¼è‡´ API ç ´å

**å½±å“**ï¼šAPI ç«¯ç‚¹å˜æ›´å¯¼è‡´å‰ç«¯è°ƒç”¨å¤±è´¥

**ç¼“è§£æªæ–½**ï¼š
1. **API æ–‡æ¡£å¯¹æ¯”**ï¼šè¯¦ç»†è®°å½•æ‰€æœ‰ API å˜æ›´
2. **é›†æˆæµ‹è¯•**ï¼šå‰ç«¯-åç«¯é›†æˆæµ‹è¯•è¦†ç›–
3. **æ¸è¿›å¼è¿ç§»**ï¼šæŒ‰æ¨¡å—é€æ­¥è¿ç§»ï¼Œè€Œéä¸€æ¬¡æ€§å…¨éƒ¨é‡æ„

### 5.3 æµ‹è¯•ç­–ç•¥

#### å•å…ƒæµ‹è¯•
- æ¯ä¸ªæ–°æ¥å£å’Œå·¥å…·ç±»éƒ½éœ€è¦å•å…ƒæµ‹è¯•
- æ§åˆ¶å™¨å±‚æ¯ä¸ªæ§åˆ¶å™¨éœ€è¦å•å…ƒæµ‹è¯•
- ä¸­é—´ä»¶éœ€è¦ç‹¬ç«‹çš„å•å…ƒæµ‹è¯•
- è¦†ç›–ç‡ç›®æ ‡ï¼š>80%

#### é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯æµ‹è¯•å®¹å™¨/éå®¹å™¨æ¨¡å¼åˆ‡æ¢
- æµ‹è¯•æ‰€æœ‰ AI ä»£ç†æ‰§è¡Œæµç¨‹
- ä¼šè¯ç®¡ç†å®Œæ•´æµç¨‹æµ‹è¯•
- API ç«¯ç‚¹é›†æˆæµ‹è¯•ï¼ˆè·¯ç”± â†’ æ§åˆ¶å™¨ â†’ æœåŠ¡ï¼‰
- å‰åç«¯é›†æˆæµ‹è¯•

#### æ€§èƒ½æµ‹è¯•
- åŸºå‡†æµ‹è¯•ï¼šé‡æ„å‰åæ€§èƒ½å¯¹æ¯”
- è´Ÿè½½æµ‹è¯•ï¼šå¹¶å‘è¯·æ±‚æµ‹è¯•
- å†…å­˜æ³„æ¼æ£€æµ‹
- æ§åˆ¶å™¨å±‚æ€§èƒ½å¼€é”€æµ‹è¯•

---

## å…­ã€æˆåŠŸæŒ‡æ ‡

### 6.1 ä»£ç è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | æ”¹è¿› |
|------|------|------|------|
| **æ•´ä½“ä»£ç é‡å¤ç‡** | ~35% | <5% | â†“ 86% |
| **Services é‡å¤ç‡** | ~30% | <5% | â†“ 83% |
| **Routes é‡å¤ç‡** | ~43% | <5% | â†“ 88% |
| **æ¨¡å—å¹³å‡è¡Œæ•°** | 280 è¡Œ | <150 è¡Œ | â†“ 46% |
| **æœ€å¤§å•æ–‡ä»¶è¡Œæ•°** | 1979 è¡Œ | <300 è¡Œ | â†“ 85% |
| **è·¯ç”±æ–‡ä»¶å¹³å‡è¡Œæ•°** | 463 è¡Œ | <100 è¡Œ | â†“ 78% |
| **æ§åˆ¶å™¨å¹³å‡è¡Œæ•°** | N/A | <200 è¡Œ | æ–°å¢ |
| **åœˆå¤æ‚åº¦ï¼ˆå•ä¸ªå‡½æ•°ï¼‰** | >15 | <10 | â†“ 33% |
| **æµ‹è¯•è¦†ç›–ç‡** | æœªçŸ¥ | >80% | æ–°å¢ |
| **åˆ†å±‚æ¸…æ™°åº¦** | ä½ | é«˜ | æ˜¾è‘—æ”¹å–„ |

### 6.2 åŠŸèƒ½æŒ‡æ ‡

- [ ] æ‰€æœ‰ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] å®¹å™¨/éå®¹å™¨æ¨¡å¼åˆ‡æ¢é€æ˜
- [ ] æ”¯æŒæ–°å¢ AI ä»£ç†æ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç 
- [ ] è·¯ç”±å±‚æ— ä¸šåŠ¡é€»è¾‘æ³„æ¼
- [ ] ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼
- [ ] æ— ç›´æ¥æ•°æ®åº“è®¿é—®ï¼ˆé€šè¿‡æœåŠ¡å±‚ï¼‰
- [ ] RESTful API è§„èŒƒç¬¦åˆ

### 6.3 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | è¯´æ˜ |
|------|------|------|
| æ–‡ä»¶æ“ä½œå»¶è¿Ÿå¢åŠ  | <5% | é€‚é…å™¨å¼€é”€ |
| ä¼šè¯åŠ è½½æ—¶é—´ | <3% | è§£æå™¨ä¼˜åŒ– |
| å†…å­˜å ç”¨ | <5% | æŠ½è±¡å±‚å¼€é”€ |
| å¯åŠ¨æ—¶é—´ | <10% | æ¨¡å—åŠ è½½ä¼˜åŒ– |
| æ§åˆ¶å™¨å±‚å¼€é”€ | <3% | ä¸­é—´å±‚æ€§èƒ½ |
| API å“åº”æ—¶é—´ | <5% | è·¯ç”±é‡ç»„å½±å“ |

### 6.4 å¯ç»´æŠ¤æ€§æŒ‡æ ‡

- [ ] æ–°åŠŸèƒ½å¼€å‘æ—¶é—´å‡å°‘ 30%
- [ ] Bug ä¿®å¤æ—¶é—´å‡å°‘ 40%
- [ ] ä»£ç å®¡æŸ¥æ—¶é—´å‡å°‘ 25%
- [ ] æ–‡æ¡£å®Œæ•´æ€§ >90%
- [ ] è·¯ç”±æ–‡ä»¶å¹³å‡ç†è§£æ—¶é—´ <5 åˆ†é’Ÿ
- [ ] æ§åˆ¶å™¨æ–‡ä»¶å¹³å‡ç†è§£æ—¶é—´ <10 åˆ†é’Ÿ

---

## ä¸ƒã€å®æ–½å»ºè®®

### 7.1 æ¨èå®æ–½æ–¹å¼

**æ¸è¿›å¼é‡æ„**è€Œéä¸€æ¬¡å…¨é¢æ”¹é€ 

**ç†ç”±**ï¼š
1. é™ä½é£é™©ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½å¯ç‹¬ç«‹éªŒè¯
2. å¯ä»¥éšæ—¶åœæ­¢ï¼Œå·²å®Œæˆçš„é˜¶æ®µä»æœ‰ä»·å€¼
3. å­¦ä¹ æ›²çº¿å¹³ç¼“ï¼Œå›¢é˜Ÿå®¹æ˜“é€‚åº”

### 7.2 å›¢é˜Ÿåä½œ

- **ä»£ç å®¡æŸ¥**ï¼šæ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡Œå…¨é¢å®¡æŸ¥
- **çŸ¥è¯†åˆ†äº«**ï¼šé‡æ„è¿‡ç¨‹ä¸­çš„è®¾è®¡å†³ç­–éœ€è¦å›¢é˜ŸåŒæ­¥
- **æ–‡æ¡£å…ˆè¡Œ**ï¼šæ¥å£è®¾è®¡å…ˆäºå®ç°å®Œæˆ

### 7.3 è´¨é‡ä¿è¯

- **è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼šCI/CD æµç¨‹ä¸­åŒ…å«è‡ªåŠ¨åŒ–æµ‹è¯•
- **æ€§èƒ½ç›‘æ§**ï¼šç›‘æ§å…³é”®æ€§èƒ½æŒ‡æ ‡
- **é”™è¯¯è¿½è¸ª**ï¼šè¯¦ç»†è®°å½•é‡æ„æœŸé—´çš„é—®é¢˜

---

## å…«ã€ç›¸å…³æ–‡æ¡£

- [æ¶æ„æ¦‚è¿°](./architecture-overview.md)
- [æ ¸å¿ƒæ¨¡å—è®¾è®¡](./core-modules-design.md)
- [æ•°æ®å­˜å‚¨è®¾è®¡](./data-storage-design.md)
- [å®‰å…¨ä¸éƒ¨ç½²é…ç½®](./security-deployment-config.md)

---

**æ–‡æ¡£ç»´æŠ¤**

æœ¬æ–‡æ¡£åº”è¯¥æ ¹æ®é‡æ„è¿›å±•æŒç»­æ›´æ–°ã€‚å¦‚æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

**ç‰ˆæœ¬å†å²**

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | å˜æ›´è¯´æ˜ |
|------|------|------|----------|
| 1.0 | 2026-01-12 | Claude | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´é‡æ„æ–¹æ¡ˆ |
| 1.1 | 2026-01-12 | Claude | ç§»é™¤å‘åå…¼å®¹ç­–ç•¥ï¼Œç³»ç»Ÿå°šæœªæŠ•å…¥ä½¿ç”¨ |
| 2.0 | 2026-01-12 | Claude | æ•´åˆ Routes å±‚é‡æ„åˆ†æï¼Œå¼•å…¥æ§åˆ¶å™¨å±‚ï¼Œæ›´æ–°æ•´ä½“æ¶æ„æ–¹æ¡ˆ |
